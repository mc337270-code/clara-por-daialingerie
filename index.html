<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sistema de Produtos</title>

<style>
    body { background:#fce4ec; font-family: Arial; padding:20px; }
    .box { background:white; max-width:900px; margin:auto; padding:20px; border-radius:12px; }
    input, button { width:100%; padding:10px; margin:8px 0; border-radius:8px; border:1px solid #bbb; }
    button { background:#ad1457; color:white; font-weight:bold; cursor:pointer; }
    button:hover { background:#8e0c45; }
    .result-card {
        background:#fff0f6; border:1px solid #ddd; padding:12px; margin-top:10px; border-radius:10px;
    }
    .two-buttons {
        display:flex; gap:10px; margin-top:10px;
    }
    .two-buttons button {
        width:50%;
    }
</style>
</head>
<body>

<div class="box">
<h1 style="text-align:center;color:#880e4f;">Cadastro de Produtos</h1>

<h2>Cadastrar / Editar</h2>

<label>Nome</label>
<input id="nome">

<label>Tamanho</label>
<input id="tamanho">

<label>Código</label>
<input id="codigo">

<label>Preço</label>
<input id="preco" type="number" step="0.01">

<button onclick="salvar()">Salvar Produto</button>

<hr>

<h2>Buscar Produto</h2>
<input id="busca" onkeyup="buscar()" placeholder="Digite nome ou código...">

<div id="resultado"></div>
</div>

<script>
/* banco de dados */
let produtos = JSON.parse(localStorage.getItem("produtos_bd") || "[]");

/* inputs */
const nome = document.getElementById("nome");
const tamanho = document.getElementById("tamanho");
const codigo = document.getElementById("codigo");
const preco = document.getElementById("preco");
const busca = document.getElementById("busca");

/* Salvar ou editar produto */
function salvar(){
    if(!nome.value.trim() || !codigo.value.trim()){
        alert("Nome e código são obrigatórios.");
        return;
    }

    let existente = produtos.find(p => p.codigo === codigo.value.trim());

    if(existente){
        // Editando
        existente.nome = nome.value.trim();
        existente.tamanho = tamanho.value.trim();
        existente.preco = preco.value.trim();
    } else {
        // Novo produto
        produtos.push({
            nome: nome.value.trim(),
            tamanho: tamanho.value.trim(),
            codigo: codigo.value.trim(),
            preco: preco.value.trim()
        });
    }

    localStorage.setItem("produtos_bd", JSON.stringify(produtos));
    alert("Produto salvo!");

    limparCampos();
    buscar();
}

/* Buscar produtos */
function buscar(){
    let termo = busca.value.toLowerCase();

    let filtrados = produtos.filter(p =>
        p.nome.toLowerCase().includes(termo) ||
        p.codigo.includes(termo)
    );

    render(filtrados);
}

/* Carregar para edição */
function carregar(cod){
    let p = produtos.find(x => x.codigo === cod);
    if(!p) return;

    nome.value = p.nome;
    tamanho.value = p.tamanho;
    codigo.value = p.codigo;
    preco.value = p.preco;
}

/* Excluir produto */
function excluir(cod){
    if(!confirm("Deseja mesmo excluir este produto?")) return;

    produtos = produtos.filter(p => p.codigo !== cod);
    localStorage.setItem("produtos_bd", JSON.stringify(produtos));
    buscar();
}

/* Mostrar resultados */
function render(lista){
    const div = document.getElementById("resultado");
    div.innerHTML = "";

    if(lista.length === 0){
        div.innerHTML = "<p>Nenhum produto encontrado.</p>";
        return;
    }

    lista.forEach(p=>{
        div.innerHTML += `
            <div class="result-card">
                <strong>${p.nome}</strong><br>
                Tamanho: ${p.tamanho}<br>
                Código: ${p.codigo}<br>
                Preço: R$ ${p.preco}
                
                <div class="two-buttons">
                    <button onclick="carregar('${p.codigo}')">Editar</button>
                    <button onclick="excluir('${p.codigo}')">Excluir</button>
                </div>
            </div>
        `;
    });
}

/* Limpar formulário */
function limparCampos(){
    nome.value = "";
    tamanho.value = "";
    codigo.value = "";
    preco.value = "";
}

buscar();
</script>

</body>
</html>
